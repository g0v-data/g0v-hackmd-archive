---
title: 用試算表玩資料，VLOOKUP 怎麼用 #SSR2021 課程 QA
tags: edu,SSR2021
---
# 「用試算表玩資料，VLOOKUP 怎麼用」#SSR2021 課程 QA <br>講師：Ronny

:::warning
**零時小學校「夏日源理」2021 線上源力增能營**
- [首頁連結](https://g0v.hackmd.io/@jothon/Sch001SSR2021)
- [簡介連結](https://g0v.hackmd.io/@jothon/Sch001SSR2021info)
:::

## 有些縣市鄉鎮會對不到（例如桃園縣），該如何處理？
這就是在做資料處理時常會遇到的問題，「清理資料」。這次提供的課堂資料因為剛好遇到兩個資料來源提供的資料不同，一邊給的是「桃園市中壢區」一邊給的是「桃園縣中壢市」，因此用 VLOOKUP 會連結不起來。通常能做的就只有手動清理資料了。這在處理台灣鄉鎮資料很常會遇到，類似的情況還有如下：
1. 「臺中市中區」和「臺中市中　區」（後者「中」和「區」中間有一個全形空白）
2. 「台北市中山區」和「臺北市中山區」
如果資料量小並且一次性的話，可以考慮用搜尋取代功能直接手動修改資料。不過如果資料量大且可能跨到不同時間維度，那就會有很多不同方法需要引入了，例如先把縣市鄉鎮都轉成[行政區代碼](https://zh.wikipedia.org/wiki/%E6%88%B6%E5%BD%B9%E6%94%BF%E8%B3%87%E8%A8%8A%E7%B3%BB%E7%B5%B1%E8%B3%87%E6%96%99%E4%BB%A3%E7%A2%BC)。跨時間資料處理時也要注意是否有遇到行政區重劃，可以參考[segis 歷史村里變化](https://ronnywang.github.io/segis-village/)


## 遇到有 #N/A 或 #ERROR 數字錯誤，造成無法排序該怎麼辦？
治本就是把資料錯誤修正，讓他不會因為 VLOOKUP 找不到東西算不出數字來。但是假如有時這些錯誤可以忽略掉，想要治標跳過錯誤的部份的話，可以用 =IFERROR() 這個函式，他的用法是 =IFERROR(value1, value2)。如果 value1 第一個參數是正常數字他就會回傳 value1 ，但假如他是 #N/A 或是 #ERROR 等錯誤了，他就會改傳 value2。所以可以用 =IFERROR(VLOOKUP(...), 0) 。這樣如果 VLOOKUP 無法正常抓到東西時，他不會顯示 ERROR ，而是改變成顯示 0

## 請問如果我要依照班級排名順序，由小到大調整所有列的前後位置，可以在試算表做到嗎？
只要先用「凍結窗格」功能，滑鼠先移到左邊「第1行」行號的上方框線處。（下圖藍色粗線的地方）
![](https://s3-ap-northeast-1.amazonaws.com/g0v-hackmd-images/uploads/upload_0c125bd9c2bd9a10aede676bee6b7fdf.png)
滑鼠按著往下拉一行，就可以把第一行的欄位行固定，如下圖
![](https://s3-ap-northeast-1.amazonaws.com/g0v-hackmd-images/uploads/upload_367cac544bd647f2758631cbec0e6b1a.png)
再來到「排名」的 「H 欄」上按右鍵，選「排序工作表（A -> Z）」，就可以把排名從前到後排序了
![](https://s3-ap-northeast-1.amazonaws.com/g0v-hackmd-images/uploads/upload_1d384619e6ea119266001b59593e25cd.png)

## 新竹嘉義烏坵問題
這是原始資料問題，原因是因為台電的鄉鎮用電資料是用郵遞區號換算的（電費帳單地址），但是郵遞區號的新竹市和嘉義市只有到市（新竹市300, 嘉義市600），因此新竹市和嘉義市就算不到區層級了。在做資料分析時很常會遇到類似的資料無法連結的情況，就可能需要特別處理了。

## 一開始在複製三年甲班成績單的時候，因為偷懶跳過“三年甲班成績單”等大字，結果貼上的時候全部資料都存在了第一格，文字都無間隔所以無法自動隔成不同欄位，不知道遇到這種情況有沒有什麼解決方法？
就是不要偷懶吧 XD，要全選來貼表格，因為不全選來貼的話，試算表本身就會誤以為你在剪貼簿裡的東西不是個表格，他就全部貼在同一格了。

## 如果傳回值在搜尋範圍的左邊第一行，能否逆向設定參數：vlookup(D3, B2:A100, -1, FALSE)？
不行喔，如果用 VLOOKUP 的話，搜尋標的一定要是範圍的最左邊。所以如果你的傳回值在左邊的話，就把他複製或是用函式貼到右邊吧。
不過如果硬要不動傳回值的話，用 MATCH 和 INDEX 兩個函式組合也可以達到類似 VLOOKUP 的效果而且不限制搜尋值一定要在最左邊，但是缺點是函式會寫得比較長和複雜一些，詳細用法可以 Google 搜尋看看「vlookup match index」應該可以找到不少教學

## 作業常見錯誤1. VLOOKUP 第二個參數範圍的部份，使用「A1:C103」寫法，忘了加 $ 錢號。
這種狀況可能造成往下複製函式時， A1:C103 變成 「A2:C104」、「A3:C105」，越後面就平移越多，造成到後面幾行如果你試著把姓名改成「賴怡英」就會找不到資料，因為賴怡英在 A2，但是你的 VLOOKUP 的範圍已經不包含 A2 了