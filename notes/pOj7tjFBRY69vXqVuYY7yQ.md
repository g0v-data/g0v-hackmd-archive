# **Open-Ran security**

### **Open-Ran基本架構** 
- **o-cloud:**  是一個物理計算平台。它承載了各種虛擬網絡功能（VNFs）和雲端網路功能（CNFs），提供這些功能給 near -RT RIC、O-CU控制平面、O-CU用戶平面和O-DU做使用。

- **SMO框架:** Open-RAN架構的核心組件，主要的責任是管理RAN domain，像是提供網絡功能的介面、工作負載管理等等，如果簡單來說的話就是負責管理網路設備。

- **Non-Real Time RIC：** 位於 SMO 內，主要功能為處理大於 1 秒以上的判斷和決策，包含基地台的資料分析、機器學習模型建立、EI（Enrichment Information）提供、Policy 制定，藉由取得 SMO 的相關資料進行運算與模型建立，對網路效能與參數進行運算和決策，透過 A1 介面對 Near-Real Time RIC 進行 Policy和機器學習模型的更新，調整網路資源的配置，改善網路品質。

- **Near-Real Time RIC：** 主要功能為處理小於 1 秒和大於 10 ms 的相關決策，依照 Non-Real Time RIC 所提供的 Policy 與 EI 進行基地台資源配置，與  E2 介面對接，藉由收集 E2 介面提供的數據對Ran做進一步優化，並對 RAN 的相關資料進行決策和分析。

- **O-CU:**  中央單元包含RU和DU資料中心的計算資源。可以控制DU操作，連結到蜂巢式網路，並與其它基地台通訊。O-CU又分成控制面與用戶面，前者可以進行RRC(Racio Resources Control)，後者負責和SDAP進行協定，但是兩者都有和PDCP協定的功能

- **O-DU:** 分散式單元連接到多個RU與中央單元 (CU)，在物理上更靠近RU。DU負責處理物理層(L1)和資料連結層(L2)的功能，包括MAC (媒體存取控制) 與RLC (無線電連結控制)。

- **O-RU:**  O-RU可以將遠端無線電單元部署在天線附近或整合到天線中，將其發送到天線與從天線發出的無線電信號轉換為數位數據進行傳輸。控制數位前端 (DFE)、下層1 (L1，物理層) 基帶處理以及前傳傳輸。

### **Open-Ran 存在的網路安全風險**

**1. Process:**
* **Prerequisites 前提條件**:
    * **運作環境可靠性** :確保運行環境的可靠性，如果有辦法提供一個可以用於審查記錄的時間戳的話就可以加強這個還境的可靠性。
    * **系統儲存安全性** :要確保儲存在外部系統中的日誌、憑證和機密的安全。可以通過使用硬件安全模組（如TPM）來解決。O-RAN 很需要一個的實體來管理基礎硬件的安全性並且作為信任根，來促進簽名和驗證功能。
    * **認證機構** : 必須由世界比較知名、而且經過充分審查的機構的完全信任和審核。

**P.S.** 這些前提不管是對傳統RAN 還是open-ran 的進行都很重要。但是，由於 Open RAN 涉及的利益相關者更多，所以這些要求比其他 RAN 的實施更難執行和驗證。
* **Ganeral Regulations 一般規範**:
    * **標準化流程** :標準化關鍵流程包括操作、管理和維護等等。Open Ran需要一個完整高效的過程，因為硬體和軟體的解耦以及模型化的關係，使這一步對於Open RAN來說更為複雜。
    * **網路複雜性** : 由於整個網路系統的複雜性和相互依賴性，導致如果網路出現了問題，大家都有理由去推卸責任，因此責任分配就會是一個疑慮。

* **privacy 隱私權**:
    * **數據、身份和個人信息洩漏:** 由於每一個國家對於網路安全的規範不一樣，不管是受害者、肇事者、資料提供者都應該要有所監控，去確保每一個人的權益。應該制定明確的指南來應對open-ran中出現的這些問題。
  
**2. People:**

* **針對用戶的安全教育:** Open ran 有較多的網路安全風險，可能需要額外的安全知識儲備，所以須要相關的教育人員。

* **識別系統參與者身分:** 明確識別和驗證參與系統實施、管理、運營和維護等不同流程的利益相關人員，而且明確規範人與人之間的責任界線。

* **系統運營內部程序穩定性:** 要給掌管各職務的組織進行訓練，同時也要制定運作前的測試SOP，確保運作穩定性。 


**3.Technology:**

* **open software**:
    * **經過信任的開元程式碼**:開源的漏洞通常會公佈在國家漏洞數據庫 (NVD) 上。這個數據庫主要是供開發者揭露漏洞的，但同時也會被駭客用來攻擊，例如利用這些漏洞攻擊管理程序、作業系統 (OS)、虛擬機 (VM) 。由於開發者經常重複使用免費的開源程式碼，所以漏洞經常會隨之傳播。因此，從未經信任的地方下載開源程式碼，會存在很大的風險。
    * **法律規範** :現行的立法並未提供明確的法律標準、指南、要求或條件。規範必須明確且透明，並且可供審查和稽核，以確保編碼的安全性。由於大量的 Open RAN 代碼是由不同國家的公司編寫的，安全稽核應該要有強制性，並且應將代碼開放給安全研究人員進行審查。
    * **專利問題** :3GPP 和 Open RAN 聯盟在處理其他成員持有的專利時，都會實行「公平、合理且不歧視」（FRANS）政策。但是更多是擔心政治問題。如果不同國家之間的貿易關係嚴重惡化，彼此競爭的製造商和提供服務的廠商所持有的專利可能會被撤出 FRANS 授權。


* **Radio/open interface**:
 
    1. **前傳(Fronthaul)** :主要功能是負責DU與RU的網路連接，Open RAN為了減少延遲、增加頻寬等等5G的硬性條件，導致在安全性方面犧牲了很多，像系統身分驗證、授權、完整性檢查等等，相對缺乏適當性流程，導致在系統安全方面比較不完善。文章分四類:

        **第一類威脅:** 
        1.  假冒合法的clock，向主要的clock 傳遞惡意訊息和發送大量的時間協議導致時間資訊不準確，再進而導致系統服務中斷。
        2.  駭客透過引入一個虛假的O-RU來使O-DU跟他進行連接，用來散播、攔截身分信息。
        3.  注入假控制平面訊息，導致O-RU在處理用戶平面封包的時候發生問題。
        
        **第二類威脅:** 
        1. 未能達成最佳實踐的話將會破壞數據完整性、機密性和可追溯性。
        2. **MITM 攻擊** :在前傳介面攔截 U-Plane 數據，並對（PTP）同步訊息和/或 PTP 延遲請求/回應訊息引入隨機的封包延遲，這會導致 PTP 偏移計算不準確，從而使clock不同步。
         
        **第三類威脅:** 
        1. 監控被入侵可能破壞 Open RAN 的監控機制以及日誌文件的完整性和可用性。

        **第四類威脅:**
        1. 破壞open ran 組件整體的話，無法保證Open RAN 軟體包完整性。會影響正在安裝或升級 Open RAN 組件時的數據、服務、硬件和政策的機密性、完整性還有可用性，會導致攻擊者對系統數據進行竄改，偽造身分等等問題。

    2. **CU/DU** :主要是隱私與安全問題，文章表示由於有些威脅並不是5G O-Ran獨有，但這些對O-Ran來說範圍及嚴重性更大，且往常的解決方案不一定會適用在5G O-Ran上，所以還是納入討論範圍:
        1. **共享unit pool**:隔離不足可能暴露用戶隱私和敏感數據。
        2. **比傳統 C-RAN 更多漏洞**:Open RAN 中的 CU 和 DU 實體的開放性和暴露性更高，使其更容易成為網絡黑客攻擊的目標。
        3. **通過 eCPRI 引入的網絡威脅**：使用eCPRI的 Open RAN 前傳，會因為融合了封包式網路而引入網絡威脅。
        4. **中傳入侵風險**：這個風險相對少見，攻擊者可能利用 DUs 的 中傳介面進行入侵。干預可能通過服務遷移、卸載等等的機制來實現。
    3. **5G Radio Network** : 
        1. **無線電干擾**: 透過故意干擾、阻塞或創造干擾，可以擾亂授權的無線網絡通信。或者干擾同步信號或溝通流(communication flow)進一步破壞 5G 服務。
        2. **利用O-Ran開放介面進行攻擊:** PBCH 信號的漏洞允許攻擊者監聽(sniffing) 5G RAN 網路狀態。開源和低成本的軟體無線電吸引了攻擊者利用軟件、協議和韌體層的現有漏洞進行攻擊。透過 RAN spoofing，攻擊者將一個假信號傳送給 RAN 中的 RF 接收器，假裝成實際信號 。PBCH 信號和軟體無線電設備的漏洞就會是spoofing attack的主要目標，


* **intelligence**:
     1. **Near - RT RIC** :
         1. **xAPP受損** :xApp被用來執行CU（中央單元）和DU（分佈單元）實體的智能功能，所以受損的XAPP有能力控制一個RU設備或是UE，甚至可以透過RIC來追蹤特定的用戶。xApp還可以通過A1介面收集所服務UE的優先信息，識別和區分服務中的UE。這些行為會侵犯重要UE的位置隱私，甚至可能操縱當前服務的優先級，從而導致RAN（無線電接入網）的性能受到影響並隱私洩露。
         2. **開源特性使配置不相容** :由於開源的特性，使出現漏洞的機率也大幅提升，容易因為一些系統架構彼此不相容導致配置系統錯誤。
         3. **冲突與隔離** :NearRT RIC和 O-gNB 之間沒有明確的功能分離所以在無線電資源管理的決策方面可能會發生衝突，像是移動性管理、准入控制、頻寬管理和負載均衡等等，最後導致功能下降。
     2. **NON - RT RIC** : 
         1. **Sniffing用戶設備 (UE) 並進行識別** :攻擊者通過介面在NON-RT RIC 中進行用戶設備（UE）監聽，以識別 UE。在R1介面的rApp 就有可能會被用作 UE 識別的「監聽器」。
         2. **rApps 中的漏洞與錯誤配置** :利用這些漏洞和配置錯誤來擾亂提供的網路服務，有可能直接接管一個 rApp 或整個（Non-RT RIC），導致系統出現失控的情況。
         3. **rApps 中的身份驗證和授權薄弱** :如果網頁前端或 REST API 介面存在軟體漏洞或出現身份驗證和授權不足，攻擊者可能會繞過身份驗證和授權，進而獲得對 rApp 的訪問權限並冒充使用者。這樣攻擊者可以任意操控這些配置、甚至在其中設置後門。
         4. **攻擊者入侵並破壞 rApps 的隔離機制** :攻擊者如果突破了 rApp的隔離，打破 rApp 的限制。駭客就可以從側面通道進行攻擊，因為是共享unit pool，所以可以從其他共存的rApp中獲取更多可用信息。
         5. **rApps 之間的衝突** :衝突的 rApp 無論是無意還是惡意地都會影響 NON-RT Open RAN 系統功能，如負載許可證調度、節能和訂閱處理等等，皆有可能導致性能方面下降或觸發DoS。
         
    3. **ML/AI** : 
        1. **無法預期的結果** :在 Open-RAN 中使用來源不明的 AI/ML 模型可能會影響使用者的安全性和隱私 。而且隨意使用這類 AI/ML 模型可能會無意中違反安全和隱私條款，並且產生的結果會有所偏頗。
            **P.S.** 這種情狀其實一般的Ran 也會有，但是在 O-RAN 中，遭受攻擊的範圍和可能性會更大更嚴重。
        2. **數據中毒(Data poisoning attacks)** :具有訪問權限的攻擊者能夠對機器學習訓練數據進行毒化，以此來破壞訓練的可靠性。這將會影響到xApps/rApps管理的Open RAN系統功能，像是移動性管理、接入控制、頻寬管理和負載均衡等等，並且導致系統性能下降。
        3. **Evasion attacks/對抗例(Adversarial examples)** :透過故意設計的數據作為機器學習模型的輸入，使其產生錯誤。這會影響由xApps/rApps管理的O-RAN系統功能，導致性能下降。但是這種攻擊僅僅適用於有明確包含 Meachine Learning Model 的O-RAN系統。所以攻擊廣度來說的話，這種攻擊範圍會比較小。
        4. **模型中毒攻擊(Model poisoning Attacks)** :擁有模型訪問權限的攻擊者可以修改機器學習模型，導致系統操控以及機器學習數據的保密性和隱私受到威脅。這會影響由 xApps/rApps 管理的 Open RAN 系統功能，導致性能下降。 
        5. **轉移學習攻擊(Transfer learning attack)** :攻擊者可以利用預訓練模型（Pre-trained model)來獲取訪問權限或避開系統的異常檢測，進行轉移學習攻擊。
        6. **逆向模型(Model inversion)& Membership Inference Attacks** : 在逆向模型攻擊中，對手試圖從模型參數中重建訓練數據集。因為有大量的在線數據庫提供訓練數據，所以為攻擊者提供了交叉驗證和確定的數據。
        7. **AI/ML 模型的複雜性** :由於 AI/ML 模型的複雜性，結果在大多數情況下仍然無法解釋。因此在 RAN 中的使用可能會導致無法預期的結果，會影響安全性或是性能。而數據中毒會直接影響 O-RAN 前傳中的無線資源分配和管理，可能會危害移動性管理、負載平衡和 QoS 管理功能的準確性。










     





                                                                                        